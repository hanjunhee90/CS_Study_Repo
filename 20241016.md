# ğŸ“˜ [tech7-ìŠ¤í”„ë§] ìˆ˜ì—… ë‚´ìš© ì •ë¦¬

## ëª©ì°¨
1. [ìˆ˜ì—… ê°œìš”](#ìˆ˜ì—…-ê°œìš”)
2. [ì£¼ìš” ê°œë…](#ì£¼ìš”-ê°œë…)
3. [ì‹¤ìŠµ ë° ì˜ˆì œ](#ì‹¤ìŠµ-ë°-ì˜ˆì œ)
4. [ì°¸ê³  ìë£Œ](#ì°¸ê³ -ìë£Œ)
5. [ì§ˆë¬¸ ë° ë‹µë³€](#ì§ˆë¬¸-ë°-ë‹µë³€)

---

## ìˆ˜ì—… ê°œìš”
**ë‚ ì§œ:** 2024ë…„ 10ì›” 16ì¼  
**ê°•ì‚¬:** [nick]  
**ì£¼ì œ:** [spring framework ì˜ˆì™¸ì²˜ë¦¬ ë° ìœ íš¨ì„±ê²€ì¦]  

 - spring framework ì˜ˆì™¸ì²˜ë¦¬ ë° ìœ íš¨ì„±ê²€ì¦

---
<!-- ![spring](./img/spring.svg) -->

## ì£¼ìš” ê°œë…


Së‹¤ìŒì€ Spring Frameworkë¥¼ ì‚¬ìš©í•œ ì˜ˆì™¸ ì²˜ë¦¬ ë° ìœ íš¨ì„± ê²€ì¦ì— ëŒ€í•œ ì½”ë“œë¥¼ ì •ë¦¬í•œ ì„¤ëª…ì…ë‹ˆë‹¤:

## 1. ì˜ˆì™¸ ì²˜ë¦¬ ë° íšŒì› ë“±ë¡ ë¡œì§

```java
public void registMember(MemberVO vo) 
    throws DuplicateKeyException, DataAccessException, BizException {
    int result = dao.registMember(vo);
    if(result == 0 ) {
        throw new BizException();
    }
}
```

### ì„¤ëª…
- ì´ ë©”ì„œë“œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— íšŒì› ì •ë³´ë¥¼ ë“±ë¡í•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤.
- ê²°ê³¼ê°’ì´ 0ì´ë©´ `BizException`ì„ ë°œìƒì‹œí‚¤ë©°, ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- ë°œìƒí•  ìˆ˜ ìˆëŠ” ì˜ˆì™¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
  - `DuplicateKeyException`: ì¤‘ë³µëœ ì•„ì´ë””ê°€ ìˆì„ ë•Œ ë°œìƒ.
  - `DataAccessException`: ë°ì´í„°ë² ì´ìŠ¤ ì•¡ì„¸ìŠ¤ ë¬¸ì œë¡œ ë°œìƒ.
  - `BizException`: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ë°œìƒí•˜ëŠ” ì‚¬ìš©ì ì •ì˜ ì˜ˆì™¸.

---

## 2. íšŒì› ë“±ë¡ í¼ ë·° (`registView` ë©”ì„œë“œ)

```java
@RequestMapping("/registView")
public String registView(@ModelAttribute("member") MemberVO member) {
    return "member/registView";
}
```

### ì„¤ëª…
- `/registView` URLë¡œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ íšŒì› ë“±ë¡ í¼ í™”ë©´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
- `@ModelAttribute("member")`ëŠ” ë·°ì— `member`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ `MemberVO` ê°ì²´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.
- ì‚¬ìš©ìëŠ” ì´ í¼ì—ì„œ ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸, ì´ë¦„ ë“±ì˜ íšŒì› ì •ë³´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 3. íšŒì› ë“±ë¡ ì²˜ë¦¬ ë¡œì§ (`registDo` ë©”ì„œë“œ)

```java
@RequestMapping("/registDo")
public String registDo(@Validated(Regist.class) @ModelAttribute("member") MemberVO member,
                       BindingResult result, 
                       Model model, 
                       HttpSession session) {
    if(result.hasErrors()) {
        return "member/registView";
    }
    try {
        member.setMemPw(passwordEncoder.encode(member.getMemPw()));
        memberService.registMember(member);
    } catch (DuplicateKeyException e) {
        MessageVO messageVO = new MessageVO(false, "íšŒì›ê°€ì…", "ì¤‘ë³µ ì•„ì´ë”” ì…ë‹ˆë‹¤!", "/registView", "íšŒì›ê°€ì…");
        model.addAttribute("messageVO", messageVO);
        return "member/registView";
    } catch (DataAccessException e) {
        MessageVO messageVO = new MessageVO(false, "íšŒì›ê°€ì…", "ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤.", "/registView", "íšŒì›ê°€ì…");
        model.addAttribute("messageVO", messageVO);
        return "member/registView";
    } catch (BizException e) {
        MessageVO messageVO = new MessageVO(false, "íšŒì›ê°€ì…", "íšŒì›ê°€ì… ì‹¤íŒ¨!", "/registView", "íšŒì›ê°€ì…");
        model.addAttribute("messageVO", messageVO);
        return "member/registView";
    }
    MessageVO messageVO = new MessageVO(true, "íšŒì›ê°€ì…", "íšŒì›ê°€ì… ì„±ê³µ!", "/loginView", "ë¡œê·¸ì¸");
    model.addAttribute("messageVO", messageVO);
    return "forward:/";
}
```

### ì„¤ëª…
- `@Validated(Regist.class)`ëŠ” íšŒì› ë“±ë¡ ì‹œ ìœ íš¨ì„± ê²€ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. `Regist.class`ëŠ” ê²€ì¦ ê·¸ë£¹ì…ë‹ˆë‹¤.
- `BindingResult result`: ìœ íš¨ì„± ê²€ì¦ ê²°ê³¼ê°€ ì €ì¥ë˜ë©°, ì—ëŸ¬ê°€ ìˆìœ¼ë©´ `hasErrors()`ê°€ `true`ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
- ë¹„ë°€ë²ˆí˜¸ëŠ” `passwordEncoder.encode()`ë¡œ ì•”í˜¸í™”ë©ë‹ˆë‹¤.
- ì—¬ëŸ¬ ì˜ˆì™¸ ì²˜ë¦¬:
  - `DuplicateKeyException`: ì¤‘ë³µëœ ì•„ì´ë””ì¼ ê²½ìš°.
  - `DataAccessException`: ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ì˜¤ë¥˜.
  - `BizException`: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìƒ ë¬¸ì œ ë°œìƒ.
- ì„±ê³µ ë©”ì‹œì§€ ë˜ëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ `MessageVO`ë¡œ ì„¤ì •í•´ ë·°ì— ì „ë‹¬í•©ë‹ˆë‹¤.

---

## 4. ìœ íš¨ì„± ê²€ì¦ ë° `MemberVO` í´ë˜ìŠ¤

```java
public class MemberVO {

    @NotEmpty(message="ì•„ì´ë”” í•„ìˆ˜!!", groups= {Login.class, Regist.class})
    private String memId;

    @Pattern(regexp="^\\w{4,10}$", message="íŒ¨ìŠ¤ì›Œë“œëŠ” ì˜ë¬¸ ìˆ«ì 4 ~ 10ë¡œ ì…ë ¥!", groups= {Login.class, Regist.class})
    private String memPw;

    @Size(min=1, max=20, message="ì´ë¦„ì€ 20ì ì´ë‚´ë¡œ ì…ë ¥!!", groups= {Regist.class})
    private String memNm;
}
```

### ì„¤ëª…
- `@NotEmpty`: `memId` í•„ë“œê°€ ë¹„ì–´ìˆìœ¼ë©´ ì•ˆ ëœë‹¤ëŠ” ìœ íš¨ì„± ê²€ì¦ì„ ì„¤ì •.
- `@Pattern`: ë¹„ë°€ë²ˆí˜¸ëŠ” 4~10ìì˜ ì˜ë¬¸ìì™€ ìˆ«ìë¡œ êµ¬ì„±ë˜ì–´ì•¼ í•¨.
- `@Size`: ì´ë¦„ì€ 1ì ì´ìƒ 20ì ì´í•˜ë¡œ ì…ë ¥í•´ì•¼ í•¨.
- ê° ìœ íš¨ì„± ê²€ì¦ ì–´ë…¸í…Œì´ì…˜ì— `groups` ì†ì„±ìœ¼ë¡œ ê²€ì¦ì„ ì ìš©í•  ê·¸ë£¹ì„ ì§€ì •í•©ë‹ˆë‹¤.

---

## 5. íšŒì›ê°€ì… HTML í¼ (`registView.jsp`)

```html
<form:form modelAttribute="member" action="/registDo" method="post">
    <div class="form-floating mb-3">
        <form:input path="memId" name="memId" class="form-control" id="id" type="text" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."/>
        <form:errors path="memId" cssClass="error" />
        <label for="id">ID</label>
    </div>
    
    <div class="form-floating mb-3">
        <form:input path="memPw" name="memPw" class="form-control" id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." />
        <form:errors path="memPw" cssClass="error" />
        <label for="password">Password</label>
    </div>
    
    <div class="form-floating mb-3">
        <form:input path="memNm" name="memNm" class="form-control" id="name" type="text" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”..." />
        <form:errors path="memNm" cssClass="error" />
        <label for="id">Name</label>
    </div>

    <button class="btn btn-primary btn-xl" id="submitButton" type="submit">ê°€ì…í•˜ê¸°</button>
</form:form>
```

### ì„¤ëª…
- `form:form` íƒœê·¸ëŠ” Springì˜ í¼ ë¹Œë”ë¡œ, `modelAttribute="member"`ë¥¼ í†µí•´ `MemberVO` ê°ì²´ì™€ ë°”ì¸ë”©ë©ë‹ˆë‹¤.
- `form:input` íƒœê·¸ë¡œ ê° í•„ë“œë¥¼ ì •ì˜í•˜ê³ , `form:errors` íƒœê·¸ë¡œ ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
- ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ í•„ë“œ í•˜ë‹¨ì— ì—ëŸ¬ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.

---

## ì‹¤ìŠµ ì˜ˆì œ 


- email

```xml
		<!-- ì„œë²„ìª½ validation -->
		<dependency>
            <groupId>org.hibernate.validator</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>6.2.0.Final</version>
        </dependency>
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>2.0.1.Final</version>
        </dependency>
```


## ì°¸ê³  ìë£Œ

- 

## ì§ˆë¬¸ 
